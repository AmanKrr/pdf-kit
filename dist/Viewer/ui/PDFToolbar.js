import{PDF_VIEWER_CLASSNAMES,PDF_VIEWER_IDS}from"../../constants/pdf-viewer-selectors";import{AnnotationToolbar}from"./PDFAnnotationToolbar";class Toolbar{constructor(t,o,e=[],n={}){this._searchBarOpen=!1,this._viewer=t,this._pdfState=o,this._opts=Object.assign({showFirstPage:!0,showPrevNext:!0,showLastPage:!0,showPageNumber:!0,showZoom:!0,showSearch:!1,showThumbnail:!1,showAnnotation:!0,showDownload:!0,classPrefix:"a-toolbar"},n),this._buttons=e.length?e:this._defaultButtons(),this._annotationToolbar=new AnnotationToolbar(this._viewer,this._pdfState)}render(t){(this._container=t).innerHTML="";for(var o of this._buttons){var e;o.isSeparatorBefore&&t.appendChild(this.__addSeparator()),o.render?t.appendChild(o.render(this._viewer)):(e=this.__wrapItem(o.id),o.breakBefore&&(e.style.marginLeft="auto"),e.appendChild(this.__createButton(o)),t.appendChild(e))}}_defaultButtons(){var t=[];return this._opts.showThumbnail&&t.push({id:"thumbnail",iconClass:"thumbnail-icon",tooltip:"Toggle Thumbnails",onClick:t=>t.toogleThumbnailViewer()}),this._opts.showFirstPage&&t.push({id:"firstPage",iconClass:"first-page-icon",tooltip:"First Page",isSeparatorBefore:this._opts.showThumbnail,onClick:t=>t.firstPage()}),this._opts.showPrevNext&&t.push({id:"previousPage",iconClass:"previous-page-icon",tooltip:"Previous Page",onClick:t=>t.previousPage()},{id:"nextPage",iconClass:"next-page-icon",tooltip:"Next Page",onClick:t=>t.nextPage()}),this._opts.showLastPage&&t.push({id:"lastPage",iconClass:"last-page-icon",tooltip:"Last Page",onClick:t=>t.lastPage()}),this._opts.showPageNumber&&t.push({id:"pageNumber",render:t=>Toolbar._renderPageNumberControls(t)}),this._opts.showZoom&&t.push({id:"zoomIn",iconClass:"zoom-in-icon",tooltip:"Zoom In",isSeparatorBefore:!0,onClick:t=>t.zoomIn()},{id:"zoomOut",iconClass:"zoom-out-icon",tooltip:"Zoom Out",onClick:t=>t.zoomOut()}),this._opts.showSearch&&t.push({id:"search",iconClass:"search-icon",tooltip:"Search",onClick:t=>{this._closeAnnotationToolbar(),t.search(),this._searchBarOpen=!this._searchBarOpen},breakBefore:!0}),this._opts.showAnnotation&&t.push({id:"annotation",iconClass:"annotation-icon",tooltip:"Annotations",onClick:()=>{this._searchBarOpen&&(this._viewer.search(),this._searchBarOpen=!1),this._pdfState.isAnnotationEnabled=!this._pdfState.isAnnotationEnabled;var t=null==(t=document.querySelector(`#${this._pdfState.containerId} .${PDF_VIEWER_CLASSNAMES.A_TOOLBAR_BUTTON} .annotation-icon`))?void 0:t.parentElement;null!=t&&t.classList.toggle("active"),this._pdfState.isAnnotationEnabled?this._annotationToolbar.render():this._annotationToolbar.destroy()},breakBefore:!this._opts.showSearch}),this._opts.showDownload&&t.push({id:"download",iconClass:"download-icon",tooltip:"Download",onClick:t=>t.downloadPdf(),breakBefore:!this._opts.showSearch||!this._opts.showAnnotation}),t}_closeAnnotationToolbar(){this._pdfState.isAnnotationEnabled=!1;var t=null==(t=document.querySelector(`#${this._pdfState.containerId} .${PDF_VIEWER_CLASSNAMES.A_TOOLBAR_BUTTON} .annotation-icon`))?void 0:t.parentElement;null!=t&&t.classList.toggle("active"),this._annotationToolbar.destroy()}__createButton(t){var o=document.createElement("button"),e=(o.classList.add(this._opts.classPrefix+"-button",t.id+"-button"),t.tooltip&&o.setAttribute("title",t.tooltip),document.createElement("span"));return e.classList.add(this._opts.classPrefix+"-icon",t.iconClass||""),o.appendChild(e),t.onClick&&o.addEventListener("click",()=>t.onClick(this._viewer)),o}__wrapItem(t){var o=document.createElement("div");return o.classList.add(this._opts.classPrefix+"-item",t+"-item"),o}__addSeparator(){var t=document.createElement("div");return t.classList.add(this._opts.classPrefix+"-separator"),t}static _renderPageNumberControls(o){var t=document.createElement("div"),e=(t.id=PDF_VIEWER_IDS.INPUT_PAGE_NUMBER,t.className=PDF_VIEWER_CLASSNAMES.A_PAGE_INPUT_CONTAINER,document.createElement("input")),e=(e.type="number",e.id=PDF_VIEWER_IDS.CURRENT_PAGE_INPUT,e.className=PDF_VIEWER_CLASSNAMES.A_CURRENT_PAGE_NUMBER_INPUT_FIELD,e.autocomplete="off",e.setAttribute("aria-label","Current page number"),e.value=String(o.currentPageNumber),e.oninput=t=>o.toolbarButtonClick("currentPageNumber",t),e.onkeydown=t=>o.toolbarButtonClick("currentPageNumber",t),t.appendChild(e),document.createElement("div")),n=document.createElement("p"),n=(n.textContent="of",e.appendChild(n),document.createElement("div")),a=document.createElement("p"),a=(a.textContent=String(o.totalPages),n.appendChild(a),document.createElement("div"));return a.className=PDF_VIEWER_CLASSNAMES.A_TOOLBAR_ITEM+` ${PDF_VIEWER_CLASSNAMES.A_TOOLBAR_TOOLTIP} a-page-number-container`,a.append(t,e,n),a}destroy(){this._container&&(this._container.innerHTML=""),this._annotationToolbar.destroy()}}export{Toolbar};