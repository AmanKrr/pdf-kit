var __awaiter=this&&this.__awaiter||function(e,s,o,u){return new(o=o||Promise)(function(n,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function a(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(r,a)}i((u=u.apply(e,s||[])).next())})};class PasswordManager{constructor(e,t){var[e,t]=this._view(e,t);this._inpField=e,this._inpLabel=t,Object.freeze(PasswordManager.prototype)}set onError(e){this._inpField&&this._inpLabel&&(this._inpLabel.textContent=e,this._inpField.focus(),e=null==(e=this._inpField.parentElement)?void 0:e.parentElement)&&e.removeAttribute("style")}_hashPassword(t){return __awaiter(this,void 0,void 0,function*(){var e=(new TextEncoder).encode(t),e=yield crypto.subtle.digest("SHA-256",e);return btoa(String.fromCharCode(...new Uint8Array(e)))})}_onFormSumbit(e,t,n){e.preventDefault(),e.stopPropagation(),e.target&&(e=new FormData(e.target),this._inpField&&(this._inpField.value=""),e=e.get("pass"))&&(t(e),n.style.display="none")}_securityMeasures(e){e.oncopy=e=>e.preventDefault(),e.onpaste=e=>e.preventDefault(),e.ondragstart=e=>e.preventDefault(),e.oncontextmenu=e=>e.preventDefault(),e.autocomplete="off"}_createForm(t,n){var e=document.createElement("form"),r=document.createElement("input"),a=(r.setAttribute("id","password"),r.setAttribute("type","password"),r.setAttribute("name","pass"),document.createElement("label")),i=(a.setAttribute("for","password"),a.textContent="Enter password: ",document.createElement("input"));return i.setAttribute("type","submit"),i.setAttribute("value","Submit"),this._securityMeasures(r),e.onsubmit=e=>this._onFormSumbit(e,n,t),e.append(a,r,i),[e,r,a]}_createElement(e){var t=document.createElement("div"),[e,n,r]=(t.classList.add("a-password-viewer"),this._createForm(t,e));return t.append(e),[t,n,r]}_view(e,t){var[t,n,r]=this._createElement(t);return e.prepend(t),[n,r]}destroy(){var e;this._inpField&&(e=null==(e=this._inpField.parentElement)?void 0:e.parentElement)&&e.remove()}}export default PasswordManager;