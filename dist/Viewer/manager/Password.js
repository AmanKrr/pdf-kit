var __awaiter=this&&this.__awaiter||function(e,s,o,u){return new(o=o||Promise)(function(n,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function a(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(r,a)}i((u=u.apply(e,s||[])).next())})};class PasswordManager{constructor(e,t){var[e,t]=this.view(e,t);this.inpField=e,this.inpLabel=t,Object.freeze(PasswordManager.prototype)}set onError(e){this.inpField&&this.inpLabel&&(this.inpLabel.textContent=e,this.inpField.focus(),e=null==(e=this.inpField.parentElement)?void 0:e.parentElement)&&e.removeAttribute("style")}hashPassword(t){return __awaiter(this,void 0,void 0,function*(){var e=(new TextEncoder).encode(t),e=yield crypto.subtle.digest("SHA-256",e);return btoa(String.fromCharCode(...new Uint8Array(e)))})}onFormSumbit(e,t,n){e.preventDefault(),e.stopPropagation(),console.log("submit event",e),e.target&&(e=new FormData(e.target),this.inpField&&(this.inpField.value=""),e=e.get("pass"))&&(t(e),n.style.display="none")}securityMeasures(e){e.oncopy=e=>e.preventDefault(),e.onpaste=e=>e.preventDefault(),e.ondragstart=e=>e.preventDefault(),e.oncontextmenu=e=>e.preventDefault(),e.autocomplete="off"}createForm(t,n){var e=document.createElement("form"),r=document.createElement("input"),a=(r.setAttribute("id","password"),r.setAttribute("type","password"),r.setAttribute("name","pass"),document.createElement("label")),i=(a.setAttribute("for","password"),a.textContent="Enter password: ",document.createElement("input"));return i.setAttribute("type","submit"),i.setAttribute("value","Submit"),this.securityMeasures(r),e.onsubmit=e=>this.onFormSumbit(e,n,t),e.append(a,r,i),[e,r,a]}createElement(e){var t=document.createElement("div"),[e,n,r]=(t.classList.add("a-password-viewer"),this.createForm(t,e));return t.append(e),[t,n,r]}view(e,t){var[t,n,r]=this.createElement(t);return e.prepend(t),[n,r]}destroy(){var e;this.inpField&&(e=null==(e=this.inpField.parentElement)?void 0:e.parentElement)&&e.remove()}}export default PasswordManager;