import{aPdfViewerClassNames,aPdfViewerIds}from"../../constant/ElementIdClass";import WebUiUtils from"../../utils/WebUiUtils";import{AnnotationManager}from"../manager/AnnotationManager";import PdfState from"./PdfState";class Toolbar{constructor(e,t,a,o){this._viewer=a,this.__pdfState=PdfState.getInstance(e),this.selectionManager=o,this.toolbar={firstPage:!0,previousPage:!0,nextPage:!0,lastPage:!0,pageNumber:!0,zoomIn:!0,zoomOut:!0,rotate:!1,print:!1,download:!1,search:!1,thumbnail:!1,annotation:{signature:!1,drawing:!1,stamp:!1,circle:!1,rectangle:!0,line:!1}},this.toolbarClass={firstPage:"a-first-page-container",previousPage:"a-previous-page-container",nextPage:"a-next-page-container",lastPage:"a-last-page-container",pageNumber:"a-page-number-container",zoomIn:"a-zoom-in-container",zoomOut:"a-zoom-out-container",rotate:"a-rotate-container",print:"a-print-container",download:"a-download-container",search:"a-search-container",thumbnail:"a-thumbnail-view-container",annotation:{signature:"",drawing:"",stamp:"",circle:"",rectangle:"a-rectangle-container",line:""}},this.toolbarConfig=t.length?t:this.getToolbarData(),this.renderToolbar()}setToolbar(e={}){this.toolbar=Object.assign(Object.assign({},this.toolbar),e),this.renderToolbar()}getToolbar(){return this.toolbar}removeToolbar(){this.toolbar={}}getToolbarData(){return[{id:"thumbnailBtn",label:"View thumbnail",icon:"view-thumbnail",onClick:e=>this._viewer.toogleThumbnailViewer(),hide:!1,class:this.toolbarClass.thumbnail+"-icon",group:1},{id:"firstPage",label:"First Page",icon:"first-page-icon",onClick:e=>this._viewer.firstPage(),hide:!1,isSeparatorBefore:!0,class:this.toolbarClass.firstPage+"-icon",group:1},{id:"previousPage",label:"Previous Page",icon:"previous-page-icon",onClick:e=>this._viewer.previousPage(),hide:!1,class:this.toolbarClass.previousPage+"-icon",group:1},{id:"nextPage",label:"Next Page",icon:"next-page-icon",onClick:e=>this._viewer.nextPage(),hide:!1,class:this.toolbarClass.nextPage+"-icon",group:1},{id:"lastPage",label:"Last Page",icon:"last-page-icon",onClick:e=>this._viewer.lastPage(),hide:!1,class:this.toolbarClass.lastPage+"-icon",group:1},{id:"pageNumber",label:"Page Number",type:"custom",render:()=>Toolbar.renderPageNumberControls(this._viewer),onClick:e=>console.log("clicked"),hide:!1,group:1},{id:"zoomIn",label:"Zoom In",icon:"zoom-in-icon",onClick:e=>this._viewer.zoomIn(),isSeparatorBefore:!0,hide:!1,class:this.toolbarClass.zoomIn+"-icon",group:1},{id:"zoomOut",label:"Zoom Out",icon:"zoom-out-icon",onClick:e=>this._viewer.zoomOut(),class:this.toolbarClass.zoomOut+"-icon",hide:!1,group:1},{id:"annotation",label:"Annotate",icon:"annotate-icon",onClick:()=>{var e,t=document.querySelector(`#${this.__pdfState.containerId} #pageContainer-${this.__pdfState.currentPage} #`+aPdfViewerIds._ANNOTATION_DRAWING_LAYER);t&&((e=document.querySelector(`#${this.__pdfState.containerId} .a-annotation-container-icon`))&&(e.parentElement.style.backgroundColor="#4b4b4b"),t.style.cursor="crosshair",t.style.pointerEvents="all",(this._viewer.annotation.isAnnotationManagerRegistered(this.__pdfState.currentPage)||(e=new AnnotationManager(t,this.__pdfState,this.selectionManager),this._viewer.annotation.registerAnnotationManager(this.__pdfState.currentPage,e),e)).createRectangle("transparent","red",2,"solid"))},class:"a-annotation-container-icon",hide:!1,group:2},{id:"download",label:"Download",icon:"download-icon",onClick:e=>this._viewer.zoomOut(),class:this.toolbarClass.download+"-icon",hide:!0,group:2}]}renderToolbar(){let o=document.querySelector(`#${this.__pdfState.containerId} #toolbarContainer #`+aPdfViewerIds._TOOLBAR_GROUP_1),n=document.querySelector(`#${this.__pdfState.containerId} #toolbarContainer #`+aPdfViewerIds._TOOLBAR_GROUP_2);o&&n&&(o.textContent="",n.textContent="",this.toolbarConfig.forEach(e=>{var t,a;e.hide||(t=1===e.group?o:n,e.isSeparatorBefore&&this.addSeparator(t),"custom"===e.type&&e.render?t.appendChild(e.render(this)):(a=this.createToolbarButton(e),(e=this.parentWrapper(e)).appendChild(a),t.appendChild(e)))}),WebUiUtils.hideLoading(this.__pdfState.uiLoading,this.__pdfState.containerId))}createToolbarButton(e){var t=document.createElement("button"),a=(t.classList.add("a-toolbar-button"),document.createElement("span"));return a.setAttribute("class","a-toolbar-icon "+e.class),t.appendChild(a),t.addEventListener("click",()=>e.onClick(this._viewer)),t}parentWrapper(e){var t=document.createElement("div");return t.setAttribute("class",(aPdfViewerClassNames._A_TOOLBAR_ITEM+` ${aPdfViewerClassNames._A_TOOLBAR_TOOLTIP} `+(null!=e&&e.key?this.toolbarClass[e.key]:"")).trim()),t}addSeparator(e){var t=document.createElement("div");t.classList.add("a-toolbar-item-separator"),e.appendChild(t)}static renderPageNumberControls(t){var e=document.createElement("div"),a=(e.setAttribute("id",aPdfViewerIds._INPUT_PAGE_NUMBER),e.setAttribute("class",aPdfViewerClassNames._A_PAGE_INPUT_CONTAINER),document.createElement("input")),a=(a.setAttribute("type","number"),a.setAttribute("id",aPdfViewerIds._CURRENT_PAGE_INPUT),a.setAttribute("class",aPdfViewerClassNames._A_CURRENT_PAGE_NUMBER_INPUT_FIELD),a.setAttribute("autocomplete","off"),a.setAttribute("aria-label","Current page number"),a.value=String(t.currentPageNumber),a.oninput=e=>t.toolbarButtonClick("currentPageNumber",e),a.onkeydown=e=>t.toolbarButtonClick("currentPageNumber",e),e.appendChild(a),document.createElement("div")),o=document.createElement("p"),o=(o.textContent="of",a.appendChild(o),document.createElement("div")),n=document.createElement("p"),n=(n.textContent=String(t.totalPages),o.appendChild(n),document.createElement("div"));return n.setAttribute("class",aPdfViewerClassNames._A_TOOLBAR_ITEM+` ${aPdfViewerClassNames._A_TOOLBAR_TOOLTIP} a-page-number-container`),n.appendChild(e),n.appendChild(a),n.appendChild(o),n}static shapeTool(){}}export default Toolbar;