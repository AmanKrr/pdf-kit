var __awaiter=this&&this.__awaiter||function(e,s,p,o){return new(p=p||Promise)(function(r,t){function a(e){try{i(o.next(e))}catch(e){t(e)}}function n(e){try{i(o.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof p?t:new p(function(e){e(t)})).then(a,n)}i((o=o.apply(e,s||[])).next())})};import PageElement from"./PageElement";import{aPdfViewerClassNames,aPdfViewerIds}from"../../constant/ElementIdClass";import{TextLayer as pdfjsTextLayer}from"pdfjs-dist";class TextLayer extends PageElement{constructor(e,t,r){super(),this.pageWrapper=e,this.page=t,this.viewport=r}createTextLayer(){return __awaiter(this,void 0,void 0,function*(){var e=PageElement.createLayers(aPdfViewerClassNames._A_TEXT_LAYER,aPdfViewerIds._TEXT_LAYER,this.viewport),t=(this.pageWrapper.appendChild(e),PageElement.createLayers(aPdfViewerClassNames._A_ANNOTATION_DRAWING_LAYER,aPdfViewerIds._ANNOTATION_DRAWING_LAYER,this.viewport)),r=(this.pageWrapper.appendChild(t),yield this.page.getTextContent());return yield new pdfjsTextLayer({textContentSource:r,container:e,viewport:this.viewport}).render(),this.wrapTextLayerIntoPTag(),[e,t]})}wrapTextLayerIntoPTag(){var e,t;this.pageWrapper&&(e=this.pageWrapper.querySelector("."+aPdfViewerClassNames._A_TEXT_LAYER))&&(t=e.innerHTML,e.innerHTML="",e.innerHTML=`<p>${t}</p>`.replaceAll('<br role="presentation">',""))}copyAndPateText(){var e;this.pageWrapper&&(e=this.pageWrapper.querySelector("."+aPdfViewerClassNames._A_TEXT_LAYER))&&(e.onkeydown=this.keyDown)}keyDown(e){console.log(e)}}export default TextLayer;